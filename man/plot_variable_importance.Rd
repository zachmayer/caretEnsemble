% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/caretStack.R
\name{plot_variable_importance}
\alias{plot_variable_importance}
\title{Plot Variable Importance from a caretStack Model}
\usage{
plot_variable_importance(stack_model, newdata, stat_type = NULL)
}
\arguments{
\item{stack_model}{A \code{caretStack} model trained using \code{caretEnsemble}.
It should have an attribute \code{original_features} listing the original input variables.
If this attribute is missing, all variables are treated as "new".}

\item{newdata}{A data frame containing the data used for calculating variable importance.
Typically this should be the validation or test set.}

\item{stat_type}{Optional character string indicating which summary statistic
of the opposite group to include as a gray bar for reference.
Must be one of \code{"mean"}, \code{"sum"}, or \code{"max"}. If \code{NULL} or invalid,
no statistic is shown, and a warning will be issued if invalid.}
}
\value{
A \code{ggplot} object if no original features attribute is found,
or a \code{patchwork} object with two bar plots:
one for original features (in blue) and one for new features (in red).
If \code{stat_type} is provided, a gray bar appears in each plot representing
the selected summary statistic from the opposite group (e.g., mean of new features
shown in the original features plot).
}
\description{
This function plots the variable importance from a stacked ensemble model (`caretStack`),
separating original features from new (engineered) features. It optionally includes
cross-group summary statistics (mean, sum, or max) from one feature group into the other
for visual reference. It returns a \code{ggplot} object if all variables are treated as new,
or a \code{patchwork} object containing two plots (original and new features).
This is useful for diagnosing which group of features contributes more to the stacked model.
}
\details{
- Variable importance is computed using \code{varImp} from the \code{caret} package.
- If the model lacks the \code{original_features} attribute, all variables are considered new.
- Requires the packages: \code{data.table}, \code{ggplot2}, \code{caret}, and \code{patchwork}.
}
