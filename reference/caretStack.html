<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Combine several predictive models via stacking — caretStack • caretEnsemble</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Combine several predictive models via stacking — caretStack"><meta name="description" content="Stack several train models using a train model."><meta property="og:description" content="Stack several train models using a train model."><meta property="og:image" content="http://zachmayer.github.io/caretEnsemble/reference/figures/README-greedy-stack-6-plot.png"><meta property="og:image:alt" content="6 panel plot of an ensemble of models fit to the diamonds dataset. The RF model is the best and has the highest weight. The residual plots look good."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">caretEnsemble</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/caretEnsemble-intro.html">A Brief Introduction to caretEnsemble</a></li>
    <li><a class="dropdown-item" href="../articles/Version-4.0-New-Features.html">Version 4.0 New Features</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zachmayer/caretEnsemble/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Combine several predictive models via stacking</h1>
      <small class="dont-index">Source: <a href="https://github.com/zachmayer/caretEnsemble/blob/main/R/caretStack.R" class="external-link"><code>R/caretStack.R</code></a></small>
      <div class="d-none name"><code>caretStack.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Stack several <code><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></code> models using a <code><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></code> model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">caretStack</span><span class="op">(</span></span>
<span>  <span class="va">all.models</span>,</span>
<span>  new_X <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  new_y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metric <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  trControl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  excluded_class_id <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  original_features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  aggregate_resamples <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-all-models">all.models<a class="anchor" aria-label="anchor" href="#arg-all-models"></a></dt>
<dd><p>a caretList, or an object coercible to a caretList (such as a list of train objects)</p></dd>


<dt id="arg-new-x">new_X<a class="anchor" aria-label="anchor" href="#arg-new-x"></a></dt>
<dd><p>Data to predict on for the caretList, prior to training the stack (for transfer learning).
if NULL, the stacked predictions will be extracted from the caretList models.</p></dd>


<dt id="arg-new-y">new_y<a class="anchor" aria-label="anchor" href="#arg-new-y"></a></dt>
<dd><p>The outcome variable to predict on for the caretList, prior to training the stack
(for transfer learning).
If NULL, will use the observed levels from the first model in the caret stack
If 0, will include all levels.</p></dd>


<dt id="arg-metric">metric<a class="anchor" aria-label="anchor" href="#arg-metric"></a></dt>
<dd><p>the metric to use for grid search on the stacking model.</p></dd>


<dt id="arg-trcontrol">trControl<a class="anchor" aria-label="anchor" href="#arg-trcontrol"></a></dt>
<dd><p>a trainControl object to use for training the ensemble model. If NULL, will use defaultControl.</p></dd>


<dt id="arg-excluded-class-id">excluded_class_id<a class="anchor" aria-label="anchor" href="#arg-excluded-class-id"></a></dt>
<dd><p>The integer level to exclude from binary classification or multiclass problems.</p></dd>


<dt id="arg-original-features">original_features<a class="anchor" aria-label="anchor" href="#arg-original-features"></a></dt>
<dd><p>a character vector of the names of the original features to include in the stack or
NULL to not include any features. These features will be added to the stacked predictions from the models to
train the ensemble model.</p></dd>


<dt id="arg-aggregate-resamples">aggregate_resamples<a class="anchor" aria-label="anchor" href="#arg-aggregate-resamples"></a></dt>
<dd><p>logical, whether to aggregate resamples by keys. Default is TRUE.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to pass to the stacking model</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>S3 caretStack object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Uses either transfer learning or stacking to stack models. Assumes that all models were trained on
the same number of rows of data, with the same target values. The features, cross-validation strategies,
and model types (class vs reg) may vary however. If your stack of models were trained with different number of
rows, please provide new_X and new_y so the models can predict on a common set of data for stacking.</p>
<p>If your models were trained on different columns, you should use stacking.</p>
<p>If you have both differing rows and columns in your model set, you are out of luck. You need at least
a common set of rows during training (for stacking) or a common set of columns at
inference time for transfer learning.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Caruana, R., Niculescu-Mizil, A., Crew, G., &amp; Ksikes, A. (2004).
  Ensemble Selection from Libraries of Models.
  <a href="https://www.cs.cornell.edu/~caruana/ctp/ct.papers/caruana.icml04.icdm06long.pdf" class="external-link">https://www.cs.cornell.edu/~caruana/ctp/ct.papers/caruana.icml04.icdm06long.pdf</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="caretList.html">caretList</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="fl">3</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  methodList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rpart"</span>, <span class="st">"glm"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There were missing values in resampled performance measures.</span>
<span class="r-in"><span><span class="fu">caretStack</span><span class="op">(</span><span class="va">models</span>, method <span class="op">=</span> <span class="st">"glm"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The following models were ensembled: rpart, glm  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> caret::train model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Linear Model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> No pre-processing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Resampling: Cross-Validated (5 fold) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of sample sizes: 40, 40, 40, 40, 40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Resampling results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RMSE       Rsquared   MAE      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.1810296  0.1078031  0.1348091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Final model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)        rpart          glm  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      0.8108       0.1772       0.2663  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of Freedom: 49 Total (i.e. Null);  47 Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Null Deviance:	    1.478 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance: 1.455 	AIC: -26.96</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zachary A. Deane-Mayer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

